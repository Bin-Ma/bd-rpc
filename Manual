#################################   PRC (Phylogeny Rapid Clustering)   #########################
                                                                          Author: Ma Bin
                                                                         Data: 2021.6.20 
  
PRC.py

This script can change the aligned sequences to a list of number and match to the background information or ML tree through hierarchical clustering. For increasing the speed of this program, PCA can be selected to use for calcuating the distance between sequences.

###Part 1 -- Make PRC Database
MakePRCdb.py
############# output nucleotide-convert result
Basic options:

  Usage: MakePRCdb.py  [options] -align <location> -o <location>
  -align		location of aligned sequences. (required)
  -o			directory to store the result. (required)
  -seq_convert		location of sequences coverting rules. If no rules input, the script will use (1-pi,0,0,0,1-pi,0) as default.
  -PCA <on or off> 	Use PCA program to increase the speed or not. (default: 'on')
  -PCAcomponents	if "-PCA" is on, '-PCAcomponents' can be set as any numbers. (<=number of sequences )

############################## output information-clustering result [cluster_id/identity/density/seq_location]
Information-clustering options:

  Usage: MakePRCdb.py IC [options] -align <location> -o <location>

  -Dis_exponent			The exponent of minkowski distance. (default: 2)
  -clustering_method		The method of hierarchical clustering. ('single', 'average', 'complete', 'ward') (default: 'single')
  -clustering_information	The location of sequences backgroud information. (csv file) [seq_id,clade,subclade,sub-subclade....]
  -clustering_number		If '-clustering_information' not apply, the numebr of cluster will be calcuated with out identity. (default: 5)

#######################output Tree-clustering result [tree_location/identity/density/seq_location]
Tree-clustering options:

  Usage: MakePRCdb.py TC [options] -align <location> -o <location>

  -Dis_exponent         The exponent of minkowski distance. (default: 'on')
  -clustering_method    The method of hierarchical clustering. ('single', 'average', 'complete', 'ward') (default: 'single')
  -tree			The location of tree with newick format.
  -bootstrap_cutoff	The cutoff value to stop the tree traversal. (default: 90)
#########################################################################################

###Part 2 -- Clustering new sequences
  PRCclustering.py 
#######################output gap-t-test result [seq_id in/out]
Basic options:

  Usage PRCclustering.py [options] -align <location> -new <location> -o <location>
  -align                location of aligned sequences. (required)
  -new                  location of new sequences. (required)
  -o                    directory to store the result. (required) [combined sequences, gap-t-test result]

#######################output clustering result [seq_id cluster_name/tree_location] / new tree
Clustering-new-sequences options:

  Usage: PRCclustering.py CNS [options] -align <location> -new <location> -o <location> -db <location> (combine gap-t-test)
                                                                or
         PRCclustering.py CNS [options] -combine <location> -o <location> -db <location>
 
  -combine		location of combined-align sequences. (if new sequences will be clusterd without gap-t-test, combined-align sequences should be required)
  -db			location of PRC database. (required)
  -tree			location of phylogentics tree. (if tree is available, the new sequences will add to the phylogentics tree)
  -tree_code            if '-tree' is available, the command to estimate tree can be set as follow. (default: 'iqtree -s <input> -B 1000 -T auto')
  
















